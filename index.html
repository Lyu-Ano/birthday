<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¥é©¬é‡‘æˆç”Ÿæ—¥å¿«ä¹ï¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: relative;
            background: #0d0d0e;
            font-family: "Microsoft Yahei", sans-serif;
        }

        /* å¼€åœºè§†é¢‘å…¨å±é€‚é… */
        #intro-video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #050505;
            z-index: 999;
            transition: opacity 1s ease;
        }
        #intro-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* æ ‡é¢˜æ ·å¼ */
        h1, h2, h3 {
            position: absolute;
            width: 100%;
            text-align: center;
            left: 0;
            right: 0;
            z-index: 99;
            pointer-events: none;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(2px);
            -webkit-backdrop-filter: blur(2px);
            padding: 8px 15px;
            border-radius: 8px;
            line-height: 1.6;
            max-width: 90%;
            margin: 0 auto;
            text-shadow: none !important;
        }
        h1 {
            top: 12%;
            font-size: 6vmin;
            color: #00bfff;
            animation: slideUp 1s ease-out 0.5s both;
        }
        h3 {
            top: 50%;
            transform: translateY(-50%) !important;
            font-size: 2.8vmin;
            color: #b58decd2;
            animation: fadeIn 1s ease-out 1.5s both;
            font-style: italic;
            letter-spacing: 0.5px;
        }
        h2 {
            bottom: 15%;
            font-size: 3.2vmin;
            color: #32cd32;
            animation: slideUp 1s ease-out 1s both;
        }

        /* çƒŸèŠ±ç”»å¸ƒ */
        #fireworks {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 5;
        }

        /* æ’­æ”¾æŒ‰é’®ï¼ˆä»…åœ¨è‡ªåŠ¨æ’­æ”¾å¤±è´¥æ—¶æ˜¾ç¤ºï¼‰ */
        #play-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 30px;
            font-size: 16px;
            cursor: pointer;
            display: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes floatUp {
            to { transform: translateY(-100px); opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- å¼€åœºè§†é¢‘ -->
    <div id="intro-video-container">
        <video id="intro-video" muted playsinline>
            <!-- æ›¿æ¢ä¸ºä½ çš„è§†é¢‘æ–‡ä»¶è·¯å¾„ -->
            <source src="è§†é¢‘l.mp4" type="video/mp4">
            ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
        </video>
    </div>

    <!-- è§†é¢‘ä¸“å±éŸ³é¢‘ï¼ˆä¸è§†é¢‘åŒæ­¥æ’­æ”¾ï¼‰ -->
    <audio id="video-audio" preload="auto">
        <!-- æ›¿æ¢ä¸ºä½ çš„è§†é¢‘éŸ³é¢‘æ–‡ä»¶è·¯å¾„ -->
        <source src="yin.mp3" type="audio/mpeg">
        ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
    </audio>
    <!-- èƒŒæ™¯éŸ³ä¹ï¼ˆè§†é¢‘ç»“æŸåæ’­æ”¾ï¼‰ -->
    <audio id="bg-music" loop preload="auto">
        <!-- æ›¿æ¢ä¸ºä½ çš„èƒŒæ™¯éŸ³ä¹æ–‡ä»¶è·¯å¾„ -->
        <source src="éŸ³ä¹.mp3" type="audio/mpeg">
        ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
    </audio>

    <!-- æ‰‹åŠ¨æ’­æ”¾æŒ‰é’®ï¼ˆä»…åœ¨æµè§ˆå™¨é˜»æ­¢è‡ªåŠ¨æ’­æ”¾æ—¶æ˜¾ç¤ºï¼‰ -->
    <button id="play-button">ğŸ”Š ç‚¹å‡»æ’­æ”¾éŸ³ä¹</button>

    <!-- é¡µé¢æ–‡å­— -->
    <h1>ç¥é©¬é‡‘æˆç”Ÿæ—¥å¿«ä¹ï¼</h1>
    <h3>â€œæ­¤é©¬è‹¥é‚åƒé‡Œå¿—ï¼Œè¿½é£çŠ¹å¯åˆ°å¤©æ¶¯ã€‚â€<br>
        åœ¨é©¬å¹´ç¥ä½ ç”Ÿæ—¥å¿«ä¹ï¼Œçƒ¦æ¼é©¬ä¸Šæ¶ˆï¼<br>
        money é©¬ä¸Šæœ‰ï¼Œç¦æ°”é©¬ä¸Šåˆ°ï¼</h3>
    <h2>åˆä½œè€…ï¼šå¼ ï¼Œå¤ï¼Œç”˜ï¼Œæ«ï¼Œäº¬</h2>

    <canvas id="fireworks"></canvas>

    <script>
        (function() {
            'use strict';

            // ========== è·å–DOMå…ƒç´  ==========
            const videoContainer = document.getElementById('intro-video-container');
            const introVideo = document.getElementById('intro-video');
            const videoAudio = document.getElementById('video-audio');
            const bgMusic = document.getElementById('bg-music');
            const playButton = document.getElementById('play-button');
            const h1 = document.querySelector('h1');
            const h2 = document.querySelector('h2');
            const h3 = document.querySelector('h3');

            // åˆå§‹éšè—æ–‡å­—
            h1.style.display = 'none';
            h2.style.display = 'none';
            h3.style.display = 'none';

            // ========== çŠ¶æ€æ ‡è®° ==========
            let isVideoEnded = false;        // è§†é¢‘æ˜¯å¦å·²ç»“æŸ
            let isVideoAudioPlaying = false; // è§†é¢‘éŸ³é¢‘æ˜¯å¦æ­£åœ¨æ’­æ”¾
            let userInteracted = false;      // ç”¨æˆ·æ˜¯å¦å·²äº¤äº’

            // ========== æ ¸å¿ƒéŸ³é¢‘æ§åˆ¶ ==========
            
            // 1. è§†é¢‘å¼€å§‹æ’­æ”¾æ—¶ï¼Œå°è¯•æ’­æ”¾è§†é¢‘éŸ³é¢‘
            introVideo.addEventListener('play', function() {
                if (isVideoEnded) return; // è§†é¢‘å·²ç»“æŸï¼Œä¸æ’­æ”¾
                
                // å°è¯•æ’­æ”¾è§†é¢‘éŸ³é¢‘
                videoAudio.play()
                    .then(() => {
                        isVideoAudioPlaying = true;
                        console.log('âœ… è§†é¢‘éŸ³é¢‘æ’­æ”¾ä¸­');
                    })
                    .catch(error => {
                        console.log('â¸ï¸ è§†é¢‘éŸ³é¢‘è¢«é˜»æ­¢ï¼Œç­‰å¾…ç”¨æˆ·äº¤äº’:', error);
                        // æ˜¾ç¤ºæ’­æ”¾æŒ‰é’®
                        playButton.style.display = 'block';
                        playButton.textContent = 'ğŸ”Š ç‚¹å‡»æ’­æ”¾è§†é¢‘å£°éŸ³';
                    });
            });

            // 2. è§†é¢‘æš‚åœæ—¶ï¼ˆåŒ…æ‹¬ç»“æŸï¼‰ï¼Œæš‚åœè§†é¢‘éŸ³é¢‘
            introVideo.addEventListener('pause', function() {
                if (isVideoAudioPlaying) {
                    videoAudio.pause();
                    isVideoAudioPlaying = false;
                }
            });

            // 3. è§†é¢‘ç»“æŸå¤„ç†
            function handleVideoEnd() {
                if (isVideoEnded) return;
                isVideoEnded = true;
                
                console.log('ğŸ¬ è§†é¢‘ç»“æŸ');
                
                // åœæ­¢å¹¶é‡ç½®è§†é¢‘éŸ³é¢‘
                videoAudio.pause();
                videoAudio.currentTime = 0;
                isVideoAudioPlaying = false;
                
                // éšè—è§†é¢‘å®¹å™¨
                videoContainer.style.opacity = '0';
                
                setTimeout(() => {
                    videoContainer.style.display = 'none';
                    
                    // æ˜¾ç¤ºæ–‡å­—
                    h1.style.display = 'block';
                    h2.style.display = 'block';
                    h3.style.display = 'block';
                    
                    // å¯åŠ¨çƒŸèŠ±
                    startFireworks();
                    
                    // å»¶è¿Ÿå¯åŠ¨èƒŒæ™¯éŸ³ä¹ï¼ˆç¡®ä¿å®Œå…¨é”™å¼€ï¼‰
                    setTimeout(() => {
                        // å¦‚æœç”¨æˆ·å·²ç»äº¤äº’è¿‡ï¼Œç›´æ¥æ’­æ”¾
                        if (userInteracted) {
                            bgMusic.play()
                                .then(() => console.log('ğŸµ èƒŒæ™¯éŸ³ä¹æ’­æ”¾ä¸­'))
                                .catch(err => console.log('èƒŒæ™¯éŸ³ä¹æ’­æ”¾å¤±è´¥:', err));
                        } else {
                            // æœªäº¤äº’ï¼Œæ˜¾ç¤ºæ’­æ”¾æŒ‰é’®
                            playButton.style.display = 'block';
                            playButton.textContent = 'ğŸ”Š ç‚¹å‡»æ’­æ”¾èƒŒæ™¯éŸ³ä¹';
                            
                            // ç§»é™¤æ—§çš„ç›‘å¬å™¨ï¼Œæ·»åŠ æ–°çš„ä¸€æ¬¡æ€§ç›‘å¬
                            const playHandler = function() {
                                userInteracted = true;
                                bgMusic.play()
                                    .then(() => {
                                        console.log('ğŸµ èƒŒæ™¯éŸ³ä¹æ’­æ”¾ä¸­');
                                        playButton.style.display = 'none';
                                    })
                                    .catch(err => console.log('èƒŒæ™¯éŸ³ä¹æ’­æ”¾å¤±è´¥:', err));
                                document.removeEventListener('click', playHandler);
                                document.removeEventListener('touchstart', playHandler);
                            };
                            
                            document.addEventListener('click', playHandler, { once: true });
                            document.addEventListener('touchstart', playHandler, { once: true });
                        }
                    }, 300); // 300mså»¶è¿Ÿç¡®ä¿éŸ³é¢‘åˆ‡æ¢å¹²å‡€
                    
                }, 1000);
            }

            // ç›‘å¬è§†é¢‘ç»“æŸ
            introVideo.addEventListener('ended', handleVideoEnd);
            introVideo.addEventListener('error', handleVideoEnd);
            
            // 15ç§’è¶…æ—¶å¼ºåˆ¶ç»“æŸ
            setTimeout(() => {
                if (!isVideoEnded) {
                    handleVideoEnd();
                }
            }, 15000);

            // ========== ç”¨æˆ·äº¤äº’å¤„ç† ==========
            function handleUserInteraction() {
                if (userInteracted) return;
                userInteracted = true;
                
                console.log('ğŸ‘† ç”¨æˆ·å·²äº¤äº’');
                
                // éšè—æ’­æ”¾æŒ‰é’®
                playButton.style.display = 'none';
                
                // å¦‚æœè§†é¢‘è¿˜åœ¨æ’­æ”¾ä¸”è§†é¢‘éŸ³é¢‘æœªæ’­æ”¾ï¼Œå°è¯•æ’­æ”¾
                if (!isVideoEnded && !isVideoAudioPlaying && !introVideo.paused) {
                    videoAudio.play()
                        .then(() => {
                            isVideoAudioPlaying = true;
                            console.log('âœ… ç”¨æˆ·äº¤äº’åè§†é¢‘éŸ³é¢‘æ’­æ”¾');
                        })
                        .catch(err => console.log('è§†é¢‘éŸ³é¢‘æ’­æ”¾å¤±è´¥:', err));
                }
                
                // å¦‚æœè§†é¢‘å·²ç»“æŸï¼Œå°è¯•æ’­æ”¾èƒŒæ™¯éŸ³ä¹
                if (isVideoEnded) {
                    bgMusic.play()
                        .then(() => console.log('âœ… ç”¨æˆ·äº¤äº’åèƒŒæ™¯éŸ³ä¹æ’­æ”¾'))
                        .catch(err => console.log('èƒŒæ™¯éŸ³ä¹æ’­æ”¾å¤±è´¥:', err));
                }
            }

            // ç›‘å¬ç”¨æˆ·äº¤äº’äº‹ä»¶
            document.addEventListener('click', handleUserInteraction);
            document.addEventListener('touchstart', handleUserInteraction);
            
            // æ’­æ”¾æŒ‰é’®ç‚¹å‡»å¤„ç†
            playButton.addEventListener('click', function(e) {
                e.stopPropagation(); // é˜»æ­¢å†’æ³¡ï¼Œé¿å…é‡å¤è§¦å‘
                handleUserInteraction();
            });

            // ========== ç¡®ä¿è§†é¢‘è‡ªåŠ¨æ’­æ”¾ ==========
            // å°è¯•è‡ªåŠ¨æ’­æ”¾è§†é¢‘ï¼ˆé™éŸ³çŠ¶æ€ï¼Œæµè§ˆå™¨é€šå¸¸å…è®¸ï¼‰
            introVideo.play().catch(error => {
                console.log('è§†é¢‘è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œç­‰å¾…ç”¨æˆ·äº¤äº’:', error);
                
                // æ˜¾ç¤ºæç¤ºæŒ‰é’®
                playButton.style.display = 'block';
                playButton.textContent = 'â–¶ï¸ ç‚¹å‡»æ’­æ”¾è§†é¢‘';
                
                // ç”¨æˆ·äº¤äº’æ—¶æ’­æ”¾è§†é¢‘
                const playVideoHandler = function() {
                    introVideo.play()
                        .then(() => console.log('âœ… ç”¨æˆ·äº¤äº’åè§†é¢‘æ’­æ”¾'))
                        .catch(err => console.log('è§†é¢‘æ’­æ”¾å¤±è´¥:', err));
                    document.removeEventListener('click', playVideoHandler);
                    document.removeEventListener('touchstart', playVideoHandler);
                };
                
                document.addEventListener('click', playVideoHandler, { once: true });
                document.addEventListener('touchstart', playVideoHandler, { once: true });
            });

            // ========== çƒŸèŠ±åŠ¨ç”» ==========
            function startFireworks() {
                const canvas = document.getElementById('fireworks');
                const ctx = canvas.getContext('2d');
                
                function resizeCanvas() {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }
                resizeCanvas();
                window.addEventListener('resize', resizeCanvas);

                class Firework {
                    constructor(x, y) {
                        this.x = Math.random() * canvas.width;
                        this.y = canvas.height;
                        this.targetX = x || Math.random() * canvas.width;
                        this.targetY = y || Math.random() * canvas.height * 0.6;
                        this.speed = Math.random() * 3 + 3;
                        this.dx = (this.targetX - this.x) / (canvas.height / this.speed);
                        this.dy = (this.targetY - this.y) / (canvas.height / this.speed);
                        this.color = `hsl(${Math.random() * 360}, 100%, 50%)`;
                        this.particles = [];
                        this.exploded = false;
                    }
                    update() {
                        if (!this.exploded) {
                            this.x += this.dx;
                            this.y += this.dy;
                            if (Math.abs(this.y - this.targetY) < 5) {
                                this.explode();
                            }
                        } else {
                            this.particles.forEach(p => p.update());
                            this.particles = this.particles.filter(p => p.opacity > 0);
                        }
                    }
                    draw() {
                        if (!this.exploded) {
                            ctx.beginPath();
                            ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
                            ctx.fillStyle = this.color;
                            ctx.fill();
                        } else {
                            this.particles.forEach(p => p.draw());
                        }
                    }
                    explode() {
                        this.exploded = true;
                        for (let i = 0; i < 100; i++) {
                            this.particles.push(new Particle(this.x, this.y, this.color));
                        }
                    }
                }
                
                class Particle {
                    constructor(x, y, color) {
                        this.x = x;
                        this.y = y;
                        this.vx = (Math.random() - 0.5) * 10;
                        this.vy = (Math.random() - 0.5) * 10;
                        this.opacity = 1;
                        this.color = color;
                        this.decay = Math.random() * 0.02 + 0.01;
                    }
                    update() {
                        this.x += this.vx;
                        this.y += this.vy;
                        this.vy += 0.1;
                        this.opacity -= this.decay;
                    }
                    draw() {
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, 1, 0, Math.PI * 2);
                        ctx.fillStyle = `hsla(${this.color.match(/\d+/)[0]}, 100%, 50%, ${this.opacity})`;
                        ctx.fill();
                    }
                }
                
                let fireworks = [];
                const messages = [
                    'ç”Ÿæ—¥å¿«ä¹ï¼', 'å¤©å¤©å¼€å¿ƒï¼', 'æ˜¯è°åˆè€ä¸€å²å•Š~', 
                    'è¿˜æ´»ç€ï¼ŒæŒºä¸é”™', 'ğŸ‚ğŸ‚ğŸ‚ğŸ‚ğŸ‚', 'å¤šå–çƒ­æ°´ï¼Œåƒé¥±ç©¿æš–',
                    'æš´å¯ŒğŸ’°è¿™ä¹‹åå…»æˆ‘ä»¬ï¼šï¼‰', 'é©¬é©¬é©¬é©¬', 'derå—’derå“’', 'é©¬è¹„å“’å“’å“’'
                ];
                
                function loop() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    if (Math.random() < 0.05) {
                        fireworks.push(new Firework());
                    }
                    fireworks.forEach(fw => {
                        fw.update();
                        fw.draw();
                    });
                    fireworks = fireworks.filter(fw => fw.particles.length > 0 || !fw.exploded);
                    requestAnimationFrame(loop);
                }
                loop();
                
                // ç‚¹å‡»è§¦å‘çƒŸèŠ±å’Œç¥ç¦è¯­
                canvas.addEventListener('click', (e) => {
                    fireworks.push(new Firework(e.clientX, e.clientY));
                    const bubble = document.createElement('div');
                    bubble.textContent = messages[Math.floor(Math.random() * messages.length)];
                    bubble.style.position = 'absolute';
                    bubble.style.left = (e.clientX - 50) + 'px';
                    bubble.style.top = (e.clientY - 20) + 'px';
                    bubble.style.color = '#fff';
                    bubble.style.fontSize = '4vmin';
                    bubble.style.fontWeight = 'bold';
                    bubble.style.pointerEvents = 'none';
                    bubble.style.animation = 'floatUp 2s forwards';
                    bubble.style.zIndex = 15;
                    bubble.style.textShadow = '0 0 10px rgba(0,0,0,0.5)';
                    document.body.appendChild(bubble);
                    setTimeout(() => bubble.remove(), 2000);
                });
            }
        })();
    </script>
</body>
</html>